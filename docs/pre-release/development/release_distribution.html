


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Release and Distribution &mdash; QuTiP 5.0 Documentation</title>
  

  
  <link rel="stylesheet" href="../static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../static/gallery-rendered-html.css" type="text/css" />
  <link rel="stylesheet" href="../static/site.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../static/documentation_options.js"></script>
        <script src="../static/jquery.js"></script>
        <script src="../static/underscore.js"></script>
        <script src="../static/doctools.js"></script>
    
    <script type="text/javascript" src="../static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Bibliography" href="../biblio.html" />
    <link rel="prev" title="Working with the QuTiP Documentation" href="docs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> QuTiP: Quantum Toolbox in Python
          

          
          </a>

          
            
            
              <div class="version">
                5.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../frontmatter.html">Frontmatter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/guide.html">Users Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/build/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/apidoc.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Developers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="development.html">Development Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="contributing.html">Contributing to QuTiP Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="roadmap.html">QuTiP Development Roadmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="ideas.html">Ideas for future QuTiP development</a></li>
<li class="toctree-l2"><a class="reference internal" href="docs.html">Working with the QuTiP Documentation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Release and Distribution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#preamble">Preamble</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-the-release-branch">Setting Up The Release Branch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#updating-the-requirements">Updating the Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#updating-the-changelog">Updating the Changelog</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-a-new-minor-or-major-release">Create a New Minor or Major Release</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-a-bug-fix-release">Create a Bug Fix Release</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#build-release-distribution-and-deploy">Build Release Distribution and Deploy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#build-and-deploy">Build and Deploy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#download-built-files">Download Built Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#monitoring-progress-optional">Monitoring Progress (optional)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#getting-the-built-documentation">Getting the Built Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#making-a-release-on-github">Making a Release on GitHub</a></li>
<li class="toctree-l3"><a class="reference internal" href="#website">Website</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#copying-new-files">Copying New Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#html-file-updates">HTML File Updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#conda-forge">Conda Forge</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../biblio.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">Copyright and Licensing</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuTiP: Quantum Toolbox in Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="development.html">Development Documentation</a> &raquo;</li>
        
      <li>Release and Distribution</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="release-and-distribution">
<span id="release-distribution"></span><h1>Release and Distribution<a class="headerlink" href="#release-and-distribution" title="Permalink to this headline">¶</a></h1>
<div class="section" id="preamble">
<h2>Preamble<a class="headerlink" href="#preamble" title="Permalink to this headline">¶</a></h2>
<p>This document covers the process for managing updates to the current minor release and making new releases.
Within this document, the git remote <code class="docutils literal notranslate"><span class="pre">upstream</span></code> refers to the main QuTiP organsiation repository, and <code class="docutils literal notranslate"><span class="pre">origin</span></code> refers to your personal fork.</p>
<p>In short, the steps you need to take are:</p>
<ol class="arabic simple">
<li><p>Prepare the release branch (see <a class="reference internal" href="#git">git</a>).</p></li>
<li><p>Run the “Build wheels, optionally deploy to PyPI” GitHub action to build binary and source packages and upload them to PyPI (see <a class="reference internal" href="#deploy">deploy</a>).</p></li>
<li><p>Retrieve the built documentation from GitHub (see <a class="reference internal" href="#docbuild">docbuild</a>).</p></li>
<li><p>Create a GitHub release and uploaded the built files to it (see <a class="reference internal" href="#github">github</a>).</p></li>
<li><p>Update <a class="reference external" href="https://qutip.org/">qutip.org</a> with the new links and documentation (<a class="reference internal" href="#web">web</a>).</p></li>
<li><p>Update the conda feedstock, deploying the package to <code class="docutils literal notranslate"><span class="pre">conda</span></code> (<a class="reference internal" href="#cforge">cforge</a>).</p></li>
</ol>
</div>
<div class="section" id="setting-up-the-release-branch">
<span id="git"></span><h2>Setting Up The Release Branch<a class="headerlink" href="#setting-up-the-release-branch" title="Permalink to this headline">¶</a></h2>
<p>In this step you will prepare a git branch on the main QuTiP repository that has the state of the code that is going to be released.
This procedure is quite different if you are releasing a new minor or major version compared to if you are making a bugfix patch release.
For a new minor or major version, do <a class="reference internal" href="#update-changelog">update-changelog</a> and then jump to <a class="reference internal" href="#release">release</a>.
For a bug fix to an existing release, do <a class="reference internal" href="#update-changelog">update-changelog</a> and then jump to <a class="reference internal" href="#bugfix">bugfix</a>.</p>
<p>Changes that are not backwards-compatible may only be made in a major release.
New features that do not affect backwards-compatibility can be made in a minor release.
Bug fix releases should be small, only fix bugs, and not introduce any new features.</p>
<p>There are a few steps that <em>should</em> have been kept up-to-date during day-to-day development, but might not be quite accurate.
For every change that is going to be part of your release, make sure that:</p>
<ul class="simple">
<li><p>The user guide in the documentation is updated with any new features, or changes to existing features.</p></li>
<li><p>Any new API classes or functions have entries in a suitable RST file in <code class="docutils literal notranslate"><span class="pre">doc/apidoc</span></code>.</p></li>
<li><p>Any new or changed docstrings are up-to-date and render correctly in the API documentation.</p></li>
</ul>
<p>Please make a normal PR to <code class="docutils literal notranslate"><span class="pre">master</span></code> correcting anything missing from these points and have it merged before you begin the release, if necessary.</p>
<div class="section" id="updating-the-requirements">
<span id="update-requirement"></span><h3>Updating the Requirements<a class="headerlink" href="#updating-the-requirements" title="Permalink to this headline">¶</a></h3>
<p>Ensure that QuTiP’s tests pass on the oldest version supported in the requirements.
On major and minor version, requirements can be adjusted upwards, but patch release must not change minimum requirements.
We follow <a class="reference external" href="https://numpy.org/neps/nep-0029-deprecation_policy.html">NEP29</a> for minimum supported versions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">All</span> <span class="n">minor</span> <span class="n">versions</span> <span class="n">of</span> <span class="n">Python</span> <span class="n">released</span> <span class="mi">42</span> <span class="n">months</span> <span class="n">prior</span> <span class="n">to</span> <span class="n">the</span> <span class="n">project</span><span class="p">,</span> <span class="ow">and</span> <span class="n">at</span> <span class="n">minimum</span> <span class="n">the</span> <span class="n">two</span> <span class="n">latest</span> <span class="n">minor</span> <span class="n">versions</span><span class="o">.</span>
<span class="o">-</span> <span class="n">All</span> <span class="n">minor</span> <span class="n">versions</span> <span class="n">of</span> <span class="n">numpy</span> <span class="ow">and</span> <span class="n">scipy</span> <span class="n">released</span> <span class="ow">in</span> <span class="n">the</span> <span class="mi">24</span> <span class="n">months</span> <span class="n">prior</span> <span class="n">to</span> <span class="n">the</span> <span class="n">project</span><span class="p">,</span> <span class="ow">and</span> <span class="n">at</span> <span class="n">minimum</span> <span class="n">the</span> <span class="n">last</span> <span class="n">three</span> <span class="n">minor</span> <span class="n">versions</span><span class="o">.</span>
</pre></div>
</div>
<p>If dependency versions need to be updated, update them in the master branch. The following files may need to be updated: <cite>.github/workflows/tests.yml</cite>, <cite>setup.cfg</cite> and <cite>roadmap.rst</cite>. Finally, ensure that PyPI wheels and conda builds cover at least these versions.</p>
</div>
<div class="section" id="updating-the-changelog">
<span id="update-changelog"></span><h3>Updating the Changelog<a class="headerlink" href="#updating-the-changelog" title="Permalink to this headline">¶</a></h3>
<p>This needs to be done no matter what type of release is being made.</p>
<ol class="arabic">
<li><p>Create a new branch to use to make a pull request.</p></li>
<li><p>Update the changelog using <code class="docutils literal notranslate"><span class="pre">towncrier</span></code>:</p>
<p>towncrier build –version=&lt;version-number&gt;</p>
</li>
</ol>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;version-number&gt;</span></code> is the expected version number of the release</p>
<ol class="arabic simple">
<li><p>Make a pull request on the main <code class="docutils literal notranslate"><span class="pre">qutip/qutip</span></code> repository with this changelog, and get other members of the admin team to approve it.</p></li>
<li><p>Merge this into <code class="docutils literal notranslate"><span class="pre">master</span></code>.</p></li>
</ol>
<p>Now jump to <a class="reference internal" href="#release">release</a> if you are making a major or minor release, or <a class="reference internal" href="#bugfix">bugfix</a> if you are only fixing bugs in a previous release.</p>
</div>
<div class="section" id="create-a-new-minor-or-major-release">
<span id="release"></span><h3>Create a New Minor or Major Release<a class="headerlink" href="#create-a-new-minor-or-major-release" title="Permalink to this headline">¶</a></h3>
<p>This involves making a new branch to hold the release and adding some commits to set the code into “release” mode.
This release should be done by branching directly off the <code class="docutils literal notranslate"><span class="pre">master</span></code> branch at its current head.</p>
<ol class="arabic">
<li><p>On your machine, make sure your copy of <code class="docutils literal notranslate"><span class="pre">master</span></code> is up-to-date (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">master;</span> <span class="pre">git</span> <span class="pre">pull</span> <span class="pre">upstream</span> <span class="pre">master</span></code>).
This should at least involve fetching the changelog PR that you just made.
Now create a new branch off a commit in <code class="docutils literal notranslate"><span class="pre">master</span></code> that has the state of the code you want to release.
The command is <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">-b</span> <span class="pre">qutip-&lt;major&gt;.&lt;minor&gt;.X</span></code>, for example <code class="docutils literal notranslate"><span class="pre">qutip-4.7.X</span></code>.
This branch name will be public, and must follow this format.</p></li>
<li><p>Push the new branch (with no commits in it relative to <code class="docutils literal notranslate"><span class="pre">master</span></code>) to the main <code class="docutils literal notranslate"><span class="pre">qutip/qutip</span></code> repository (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">upstream</span> <span class="pre">qutip-4.7.X</span></code>).
Creating a branch is one of the only situations in which it is ok to push to <code class="docutils literal notranslate"><span class="pre">qutip/qutip</span></code> without making a pull request.</p></li>
<li><p>Create a second new branch, which will be pushed to your fork and used to make a pull request against the <code class="docutils literal notranslate"><span class="pre">qutip-&lt;major&gt;.&lt;minor&gt;.X</span></code> branch on <code class="docutils literal notranslate"><span class="pre">qutip/qutip</span></code> you just created.
You can call this branch whatever you like because it is not going to the main repository, for example <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">-b</span> <span class="pre">prepare-qutip-4.7.0</span></code>.</p></li>
<li><ul>
<li><p>Change the <code class="docutils literal notranslate"><span class="pre">VERSION</span></code> file to contain the new version number exactly, removing the <code class="docutils literal notranslate"><span class="pre">.dev</span></code> suffix.
For example, if you are releasing the first release of the minor 4.7 track, set <code class="docutils literal notranslate"><span class="pre">VERSION</span></code> to contain the string <code class="docutils literal notranslate"><span class="pre">4.7.0</span></code>.
(<em>Special circumstances</em>: if you are making an alpha, beta or release candidate release, append a <code class="docutils literal notranslate"><span class="pre">.a&lt;n&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">.b&lt;n&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">.rc&lt;n&gt;</span></code> to the version string, where <code class="docutils literal notranslate"><span class="pre">&lt;n&gt;</span></code> is an integer starting from 0 that counts how many of that pre-release track there have been.)</p></li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> by changing the “Development Status” line in the <code class="docutils literal notranslate"><span class="pre">classifiers</span></code> section to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Development</span> <span class="n">Status</span> <span class="p">::</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">Production</span><span class="o">/</span><span class="n">Stable</span>
</pre></div>
</div>
</li>
</ul>
<p>Commit both changes (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">VERSION</span> <span class="pre">setup.cfg;</span> <span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-m</span> <span class="pre">&quot;Set</span> <span class="pre">release</span> <span class="pre">mode</span> <span class="pre">for</span> <span class="pre">4.7.0&quot;</span></code>), and then push them to your fork (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">-u</span> <span class="pre">origin</span> <span class="pre">prepare-qutip-4.7.0</span></code>)</p>
</li>
<li><p>Using GitHub, make a pull request to the release branch (e.g. <code class="docutils literal notranslate"><span class="pre">qutip-4.7.X</span></code>) using this branch that you just created.
You will need to change the “base branch” in the pull request, because GitHub will always try to make the PR against <code class="docutils literal notranslate"><span class="pre">master</span></code> at first.
When the tests have passed, merge this in.</p></li>
<li><p>Finally, back on <code class="docutils literal notranslate"><span class="pre">master</span></code>, make a new pull request that changes the <code class="docutils literal notranslate"><span class="pre">VERSION</span></code> file to be <code class="docutils literal notranslate"><span class="pre">&lt;next-expected-version&gt;.dev</span></code>, for example <code class="docutils literal notranslate"><span class="pre">4.8.0.dev</span></code>.
The “Development Status” in <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> on <code class="docutils literal notranslate"><span class="pre">master</span></code> should not have changed, and should be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Development</span> <span class="n">Status</span> <span class="p">::</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">Pre</span><span class="o">-</span><span class="n">Alpha</span>
</pre></div>
</div>
<p>because <code class="docutils literal notranslate"><span class="pre">master</span></code> is never directly released.</p>
</li>
</ol>
<p>You should now have a branch that you can see on the GitHub website that is called <code class="docutils literal notranslate"><span class="pre">qutip-4.7.X</span></code> (or whatever minor version), and the state of the code in it should be exactly what you want to release as the new minor release.
If you notice you have made a mistake, you can make additional pull requests to the release branch to fix it.
<code class="docutils literal notranslate"><span class="pre">master</span></code> should look pretty similar, except the <code class="docutils literal notranslate"><span class="pre">VERSION</span></code> will be higher and have a <code class="docutils literal notranslate"><span class="pre">.dev</span></code> suffix, and the “Development Status” in <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> will be different.</p>
<p>You are now ready to actually perform the release.
Go to <a class="reference internal" href="#deploy">deploy</a>.</p>
</div>
<div class="section" id="create-a-bug-fix-release">
<span id="bugfix"></span><h3>Create a Bug Fix Release<a class="headerlink" href="#create-a-bug-fix-release" title="Permalink to this headline">¶</a></h3>
<p>In this you will modify an already-released branch by “cherry-picking” one or more pull requests that have been merged to <code class="docutils literal notranslate"><span class="pre">master</span></code> (including your new changelog), and bump the “patch” part of the version number.</p>
<ol class="arabic">
<li><p>On your machine, make sure your copy of <code class="docutils literal notranslate"><span class="pre">master</span></code> is up-to-date (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">master;</span> <span class="pre">git</span> <span class="pre">pull</span> <span class="pre">upstream</span> <span class="pre">master</span></code>).
In particular, make sure the changelog you wrote in the first step is visible.</p></li>
<li><p>Find the branch of the release that you will be modifying.
This should already exist on the <code class="docutils literal notranslate"><span class="pre">qutip/qutip</span></code> repository, and be called <code class="docutils literal notranslate"><span class="pre">qutip-&lt;major&gt;.&lt;minor&gt;.X</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">qutip-4.6.X</span></code>).
If you cannot see it, run <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">fetch</span> <span class="pre">upstream</span></code> to update all the branch references from the main repository.
Checkout a new private branch, starting from the head of the release branch (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">-b</span> <span class="pre">prepare-qutip-4.6.1</span> <span class="pre">upstream/qutip-4.6.X</span></code>).
You can call this branch whatever you like (in the example it is <code class="docutils literal notranslate"><span class="pre">prepare-qutip-4.6.1</span></code>), because it will only be used to make a pull request.</p></li>
<li><p>Cherry-pick all the commits that will be added to this release in order, including your PR that wrote the new changelog entries (this will be the last one you cherry-pick).
You will want to use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code> to find the relevant commits, going from <strong>oldest to newest</strong> (their “age” is when they were merged into <code class="docutils literal notranslate"><span class="pre">master</span></code>, not when the PR was first opened).
The command is slightly different depending on which merge strategy was used for a particular PR:</p>
<ul class="simple">
<li><p>“merge”: you only need to find one commit though the log will have included several; there will be an entry in <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code> with a title such as “Merge pull request #1000 from &lt;…&gt;”.
Note the first 7 characters of its hash.
Cherry-pick this by <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">--mainline</span> <span class="pre">1</span> <span class="pre">&lt;hash&gt;</span></code>.</p></li>
<li><p>“squash and merge”: there will only be a single commit for the entire PR.
Its name will be “&lt;Name of the pull request&gt; (#1000)”.
Note the first 7 characters of its hash.
Cherry-pick this by <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">&lt;hash&gt;</span></code>.</p></li>
<li><p>“rebase and merge”: this is the most difficult, because there will be many commits that you will have to find manually, and cherry-pick all of them.
Go to the GitHub page for this PR, and go to the “Commits” tab.
Using your local <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code> (you may find <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">--oneline</span></code> useful), find the hash for every single commit that is listed on the GitHub page, in order from <strong>oldest to newest</strong> (top-to-bottom in the GitHub view, which is bottom-to-top in <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code>).
You will need to use the commit message to do this; the hashes that GitHub reports will probably not be the same as how they appear locally.
Find the first 7 characters of each of the hashes.
Cherry-pick these all in one go by <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">&lt;hash1&gt;</span> <span class="pre">&lt;hash2&gt;</span> <span class="pre">...</span> <span class="pre">&lt;hash10&gt;</span></code>, where <code class="docutils literal notranslate"><span class="pre">&lt;hash1&gt;</span></code> is the oldest.</p></li>
</ul>
<p>If any of the cherry-picks have merge conflicts, first verify that you are cherry-picking in order from oldest to newest.
If you still have merge conflicts, you will either need to manually fix them (if it is a <em>very</em> simple fix), or else you will need to find which additional PR this patch depends on, and restart the bug fix process including this additional patch.
This generally should not happen if you are sticking to very small bug fixes; if the fixes had far-reaching changes, a new minor release may be more appropriate.</p>
</li>
<li><p>Change the <code class="docutils literal notranslate"><span class="pre">VERSION</span></code> file by bumping the last number up by one (double-digit numbers are fine, so <code class="docutils literal notranslate"><span class="pre">4.6.10</span></code> comes after <code class="docutils literal notranslate"><span class="pre">4.6.9</span></code>), and commit the change.</p></li>
<li><p>Push this branch to your fork, and make a pull request against the release branch.
On GitHub in the PR screen, you will need to change the “Base” branch to <code class="docutils literal notranslate"><span class="pre">qutip-4.6.X</span></code> (or whatever version), because GitHub will default to making it against <code class="docutils literal notranslate"><span class="pre">master</span></code>.
It should be quite clear if you have forgotten to do this, because there will probably be many merge conflicts.
Once the tests have passed and you have another admin’s approval, merge the PR.</p></li>
</ol>
<p>You should now see that the <code class="docutils literal notranslate"><span class="pre">qutip-4.6.X</span></code> (or whatever) branch on GitHub has been updated, and now includes all the changes you have just made.
If you have made a mistake, feel free to make additonal PRs to rectify the situation.</p>
<p>You are now ready to actually perform the release.
Go to <a class="reference internal" href="#deploy">deploy</a>.</p>
</div>
</div>
<div class="section" id="build-release-distribution-and-deploy">
<span id="deploy"></span><h2>Build Release Distribution and Deploy<a class="headerlink" href="#build-release-distribution-and-deploy" title="Permalink to this headline">¶</a></h2>
<p>This step builds the source (sdist) and binary (wheel) distributions, and uploads them to PyPI (pip).
You will also be able to download the built files yourself in order to upload them to the QuTiP website.</p>
<div class="section" id="build-and-deploy">
<h3>Build and Deploy<a class="headerlink" href="#build-and-deploy" title="Permalink to this headline">¶</a></h3>
<p>This is handled entirely by a GitHub Action.
Go to the <a class="reference external" href="https://github.com/qutip/qutip/actions">“Actions” tab at the top of the QuTiP code repository</a>.
Click on the “Build wheels, optionally deploy to PyPI” action in the left-hand sidebar.
Click the “Run workflow” dropdown in the header notification; it should look like the image below.</p>
<img alt="../images/release_guide_run_build_workflow.png" src="../images/release_guide_run_build_workflow.png" />
<ul class="simple">
<li><p>Use the drop-down menu to choose the branch or tag you want to release from.
This should be called <code class="docutils literal notranslate"><span class="pre">qutip-4.5.X</span></code> or similar, depending on what you made earlier.
This must <em>never</em> be <code class="docutils literal notranslate"><span class="pre">master</span></code>.</p></li>
<li><p>To make the release to PyPI, type the branch name (e.g. <code class="docutils literal notranslate"><span class="pre">qutip-4.5.X</span></code>) into the “Confirm chosen branch name […]” field.
You <em>may</em> leave this field blank to skip the deployment and only build the package.</p></li>
<li><p>(Special circumstances) If for some reason you need to override the version number (for example if the previous deployment to PyPI only partially succeeded), you can type a valid Python version identifier into the “Override version number” field.
You probably do not need to do this.
The mechanism is designed to make alpha-testing major upgrades with nightly releases easier.
For even a bugfix release, you should commit the change to the <code class="docutils literal notranslate"><span class="pre">VERSION</span></code> file.</p></li>
<li><p>Click the lower “Run workflow” to perform the build and deployment.</p></li>
</ul>
<p>At this point, the deployment will take care of itself.
It should take between 30 minutes and an hour, after which the new version will be available for install by <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">qutip</span></code>.
You should see the new version appear on <a class="reference external" href="https://pypi.org/project/qutip">QuTiP’s PyPI page</a>.</p>
</div>
<div class="section" id="download-built-files">
<h3>Download Built Files<a class="headerlink" href="#download-built-files" title="Permalink to this headline">¶</a></h3>
<p>When the build is complete, click into its summary screen.
This is the main screen used to both monitor the build and see its output, and should look like the below image on a success.</p>
<img alt="../images/release_guide_after_workflow.png" src="../images/release_guide_after_workflow.png" />
<p>The built binary wheels and the source distribution are the “build artifacts” at the bottom.
You need to download both the wheels and the source distribution.
Save them on your computer, and unzip both files; you should have many wheel <code class="docutils literal notranslate"><span class="pre">qutip-*.whl</span></code> files, and two sdist files: <code class="docutils literal notranslate"><span class="pre">qutip-*.tar.gz</span></code> and <code class="docutils literal notranslate"><span class="pre">qutip-*.zip</span></code>.
These are the same files that have just been uploaded to PyPI.</p>
</div>
<div class="section" id="monitoring-progress-optional">
<h3>Monitoring Progress (optional)<a class="headerlink" href="#monitoring-progress-optional" title="Permalink to this headline">¶</a></h3>
<p>While the build is in progress, you can monitor its progress by clicking on its entry in the list below the “Run workflow” button.
You should see several subjobs, like the completed screen, except they might not yet be completed.</p>
<p>The “Verify PyPI deployment confirmation” should get ticked, no matter what.
If it fails, you have forgotten to choose the correct branch in the drop-down menu or you made a typo when confirming the correct branch, and you will need to restart this step.
You can check that the deployment instruction has been understood by clicking the “Verify PyPI deployment confirmation” job, and opening the “Compare confirmation to current reference” subjob.
You will see a message saying “Built wheels will be deployed” if you typed in the confirmation, or “Only building wheels” if you did not.
If you see “Only building wheels” but you meant to deploy the release to PyPI, you can cancel the workflow and re-run it after typing the confirmation.</p>
</div>
</div>
<div class="section" id="getting-the-built-documentation">
<span id="docbuild"></span><h2>Getting the Built Documentation<a class="headerlink" href="#getting-the-built-documentation" title="Permalink to this headline">¶</a></h2>
<p>The documentation will have been built automatically for you by a GitHub Action when you merged the final pull request into the release branch before building the wheels.
You do not need to re-release the documentation on either GitHub or the website if this is a patch release, unless there were changes within it.</p>
<p>Go to the “Actions” tab at the top of the <code class="docutils literal notranslate"><span class="pre">qutip/qutip</span></code> repository, and click the “Build HTML documentation” heading in the left column.
You should see a list of times this action has run; click the most recent one whose name is exactly “Build HTML documentation”, with the release branch name next to it (e.g. <code class="docutils literal notranslate"><span class="pre">qutip-4.6.X</span></code>).
Download the <code class="docutils literal notranslate"><span class="pre">qutip_html_docs</span></code> artifact to your local machine and unzip it somewhere safe.
These are all the HTML files for the built documentation; you should be able to open <code class="docutils literal notranslate"><span class="pre">index.html</span></code> in your own web browser and check that everything is working.</p>
</div>
<div class="section" id="making-a-release-on-github">
<span id="github"></span><h2>Making a Release on GitHub<a class="headerlink" href="#making-a-release-on-github" title="Permalink to this headline">¶</a></h2>
<p>This is all done through <a class="reference external" href="https://github.com/qutip/qutip/releases">the “Releases” section</a> of the <code class="docutils literal notranslate"><span class="pre">qutip/qutip</span></code> repository on GitHub.</p>
<ul class="simple">
<li><p>Click the “Draft a new release” button.</p></li>
<li><p>Choose the correct branch for your release (e.g. <code class="docutils literal notranslate"><span class="pre">qutip-4.5.X</span></code>) in the drop-down.</p></li>
<li><p>For the tag name, use <code class="docutils literal notranslate"><span class="pre">v&lt;your-version&gt;</span></code>, where the version matches the contents of the <code class="docutils literal notranslate"><span class="pre">VERSION</span></code> file.
In other words, if you are releasing a micro version 4.5.3, use <code class="docutils literal notranslate"><span class="pre">v4.5.3</span></code> as the tag, or if you are releasing major version 5.0.0, use <code class="docutils literal notranslate"><span class="pre">v5.0.0</span></code>.</p></li>
<li><p>The title is “QuTiP &lt;your-version&gt;”, e.g. “QuTiP 4.6.0”.</p></li>
<li><p>For the description, write a short (~two-line for a patch release) summary of the reason for this release, and note down any particular user-facing changes that need special attention.
Underneath, put the changelog you wrote when you did the documentation release.
Note that there may be some syntax differences between the <code class="docutils literal notranslate"><span class="pre">.rst</span></code> file of the changelog and the Markdown of this description field (for example, GitHub’s markdown typically maintains hard-wrap linebreaks, which is probably not what you wanted).</p></li>
<li><p>Drag-and-drop all the <code class="docutils literal notranslate"><span class="pre">qutip-*.whl</span></code>, <code class="docutils literal notranslate"><span class="pre">qutip-*.tar.gz</span></code> and <code class="docutils literal notranslate"><span class="pre">qutip-*.zip</span></code> files you got after the build step into the assets box.
You may need to unzip the files <code class="docutils literal notranslate"><span class="pre">wheels.zip</span></code> and <code class="docutils literal notranslate"><span class="pre">sdist.zip</span></code> to find them if you haven’t already; <strong>don’t</strong> upload those two zip files.</p></li>
</ul>
<p>Click on the “Publish release” button to finalise.</p>
</div>
<div class="section" id="website">
<span id="web"></span><h2>Website<a class="headerlink" href="#website" title="Permalink to this headline">¶</a></h2>
<p>This assumes that qutip.github.io has already been forked and familiarity with the website updating workflow.
The documentation need not be updated for every patch release.</p>
<div class="section" id="copying-new-files">
<h3>Copying New Files<a class="headerlink" href="#copying-new-files" title="Permalink to this headline">¶</a></h3>
<p>You only need to copy in new documentation to the website repository.
Do not copy the <code class="docutils literal notranslate"><span class="pre">.whl</span></code>, <code class="docutils literal notranslate"><span class="pre">.tar.gz</span></code> or <code class="docutils literal notranslate"><span class="pre">.zip</span></code> files into the git repository, because we can access the public links from the GitHub release stage, and this keeps the website <code class="docutils literal notranslate"><span class="pre">.git</span></code> folder a reasonable size.</p>
<p>For all releases move (no new docs) or copy (for new docs) the <code class="docutils literal notranslate"><span class="pre">qutip-doc-&lt;MAJOR&gt;.&lt;MINOR&gt;.pdf</span></code> into the folder <code class="docutils literal notranslate"><span class="pre">downloads/&lt;MAJOR&gt;.&lt;MINOR&gt;.&lt;MICRO&gt;</span></code>.</p>
<p>The legacy html documentation should be in a subfolder like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span><span class="o">/&lt;</span><span class="n">MAJOR</span><span class="o">&gt;.&lt;</span><span class="n">MINOR</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>For a major or minor release the previous version documentation should be moved into this folder.</p>
<p>The latest version HTML documentation should be the folder</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span><span class="o">/</span><span class="n">latest</span>
</pre></div>
</div>
<p>For any release which new documentation is included
- copy the contents <code class="docutils literal notranslate"><span class="pre">qutip/doc/_build/html</span></code> into this folder. <strong>Note that the underscores at start of the subfolder names will need to be removed, otherwise Jekyll will ignore the folders</strong>. There is a script in the <code class="docutils literal notranslate"><span class="pre">docs</span></code> folder for this.
<a class="reference external" href="https://github.com/qutip/qutip.github.io/blob/master/docs/remove_leading_underscores.py">https://github.com/qutip/qutip.github.io/blob/master/docs/remove_leading_underscores.py</a></p>
</div>
<div class="section" id="html-file-updates">
<h3>HTML File Updates<a class="headerlink" href="#html-file-updates" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">download.html</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>The ‘Latest release’ version and date should be updated.</p></li>
<li><p>The tar.gz and zip links need to have their micro release numbers updated in their filenames, labels and trackEvent javascript.
These links should point to the “Source code” links that appeared when you made in the GitHub Releases section.
They should look something like <code class="docutils literal notranslate"><span class="pre">https://github.com/qutip/qutip/archive/refs/tags/v4.6.0.tar.gz</span></code>.</p></li>
<li><p>For a minor or major release links to the last micro release of the previous version will need to be moved (copied) to the ‘Previous releases’ section.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">_includes/sidebar.html</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>The ‘Latest release’ version should be updated. The gztar and zip file links will need the micro release number updating in the traceEvent and file name.</p></li>
<li><p>The link to the documentation folder and PDF file (if created) should be updated.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">documentation.html</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>The previous release tags should be moved (copied) to the ‘Previous releases’ section.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="conda-forge">
<span id="cforge"></span><h2>Conda Forge<a class="headerlink" href="#conda-forge" title="Permalink to this headline">¶</a></h2>
<p>If not done previously then fork the <a class="reference external" href="https://github.com/conda-forge/qutip-feedstock_">qutip-feedstock</a>.</p>
<p>Checkout a new branch on your fork, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git checkout -b version-4.0.2
</pre></div>
</div>
<p>Find the sha256 checksum for the tarball that the GitHub web interface generated when you produced the release called “Source code”.
This is <em>not</em> the sdist that you downloaded earlier, it’s a new file that GitHub labels “Source code”.
When you download it, though, it will have a name that <em>looks</em> like it’s the sdist</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ openssl sha256 qutip-4.0.2.tar.gz
</pre></div>
</div>
<p>Edit the <code class="docutils literal notranslate"><span class="pre">recipe/meta.yaml</span></code> file.
Change the version at the top of the file, and update the sha256 checksum.
Check that the recipe package version requirements at least match those in <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code>, and that any changes to the build process are reflected in <code class="docutils literal notranslate"><span class="pre">meta.yml</span></code>.
Also ensure that the build number is reset</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build</span><span class="p">:</span>
    <span class="n">number</span><span class="p">:</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Push changes to your fork, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git push --set-upstream origin version-4.0.2
</pre></div>
</div>
<p>Make a Pull Request.
This will trigger tests of the package build process.</p>
<p>If (when) the tests pass, the PR can be merged, which will trigger the upload of the packages to the conda-forge channel.
To test the packages, add the conda-forge channel with lowest priority</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda config --append channels conda-forge
</pre></div>
</div>
<p>This should mean that the prerequistes come from the default channel, but the qutip packages are found in conda-forge.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../biblio.html" class="btn btn-neutral float-right" title="Bibliography" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="docs.html" class="btn btn-neutral float-left" title="Working with the QuTiP Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; <a href="../copyright.html">Copyright</a> 2011 to 2021 inclusive, QuTiP developers and contributors.
      <span class="lastupdated">
        Last updated on Feb 07, 2023.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>