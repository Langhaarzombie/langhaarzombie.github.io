
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>qutip.animation &mdash; QuTiP 5.0 Documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/site.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            QuTiP: Quantum Toolbox in Python
          </a>
              <div class="version">
                5.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../frontmatter.html">Frontmatter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guide/guide.html">Users Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery/build/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/apidoc.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/development.html">Development Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../biblio.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../copyright.html">Copyright and Licensing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QuTiP: Quantum Toolbox in Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">qutip.animation</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for qutip.animation</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Functions to animate results of quantum dynamics simulations,</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;anim_wigner_sphere&#39;</span><span class="p">,</span> <span class="s1">&#39;anim_hinton&#39;</span><span class="p">,</span> <span class="s1">&#39;anim_sphereplot&#39;</span><span class="p">,</span>
           <span class="s1">&#39;anim_matrix_histogram&#39;</span><span class="p">,</span> <span class="s1">&#39;anim_fock_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;anim_wigner&#39;</span><span class="p">,</span>
           <span class="s1">&#39;anim_spin_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;anim_qubism&#39;</span><span class="p">,</span> <span class="s1">&#39;anim_schmidt&#39;</span><span class="p">]</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="p">(</span><span class="n">plot_wigner_sphere</span><span class="p">,</span> <span class="n">hinton</span><span class="p">,</span> <span class="n">sphereplot</span><span class="p">,</span> <span class="n">matrix_histogram</span><span class="p">,</span>
               <span class="n">plot_fock_distribution</span><span class="p">,</span> <span class="n">plot_wigner</span><span class="p">,</span> <span class="n">plot_spin_distribution</span><span class="p">,</span>
               <span class="n">plot_qubism</span><span class="p">,</span> <span class="n">plot_schmidt</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.solver</span> <span class="kn">import</span> <span class="n">Result</span>


<span class="k">def</span> <span class="nf">_result_state</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Result</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">states</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Nothing to visualize. You might have forgotten &#39;</span>
                             <span class="s1">&#39;to set options={&quot;store_states&quot;: True}.&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">obj</span>


<div class="viewcode-block" id="anim_wigner_sphere"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.animation.anim_wigner_sphere">[docs]</a><span class="k">def</span> <span class="nf">anim_wigner_sphere</span><span class="p">(</span><span class="n">wigners</span><span class="p">,</span> <span class="n">reflections</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Animate a coloured Bloch sphere.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wigners : list of transformations</span>
<span class="sd">        The wigner transformation at `steps` different theta and phi.</span>

<span class="sd">    reflections : bool, default=False</span>
<span class="sd">        If the reflections of the sphere should be plotted as well.</span>

<span class="sd">    cmap : a matplotlib colormap instance, optional</span>
<span class="sd">        Color map to use when plotting.</span>

<span class="sd">    colorbar : bool, default=True</span>
<span class="sd">        Whether (True) or not (False) a colorbar should be attached.</span>

<span class="sd">    fig : a matplotlib Figure instance, optional</span>
<span class="sd">        The Figure canvas in which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axes instance, optional</span>
<span class="sd">        The ax context in which the plot will be drawn.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ani : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and the animation instance</span>
<span class="sd">        used to produce the figure.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Special thanks to Russell P Rundle for writing this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span> <span class="o">=</span> <span class="n">plot_wigner_sphere</span><span class="p">(</span><span class="n">wigners</span><span class="p">,</span> <span class="n">reflections</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                  <span class="n">colorbar</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span></div>


<div class="viewcode-block" id="anim_hinton"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.animation.anim_hinton">[docs]</a><span class="k">def</span> <span class="nf">anim_hinton</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">x_basis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_basis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color_style</span><span class="o">=</span><span class="s2">&quot;scaled&quot;</span><span class="p">,</span>
                <span class="n">label_top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws an animation of Hinton diagram.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rhos : :class:`qutip.solver.Result` or list of :class:`qutip.Qobj`</span>
<span class="sd">        Input density matrix or superoperator.</span>

<span class="sd">        .. note::</span>

<span class="sd">            Hinton plots of superoperators are currently only</span>
<span class="sd">            supported for qubits.</span>

<span class="sd">    x_basis : list of strings, optional</span>
<span class="sd">        list of x ticklabels to represent x basis of the input.</span>

<span class="sd">    y_basis : list of strings, optional</span>
<span class="sd">        list of y ticklabels to represent y basis of the input.</span>

<span class="sd">    color_style : string, default=&quot;scaled&quot;</span>

<span class="sd">        Determines how colors are assigned to each square:</span>

<span class="sd">        -  If set to ``&quot;scaled&quot;`` (default), each color is chosen by</span>
<span class="sd">           passing the absolute value of the corresponding matrix</span>
<span class="sd">           element into `cmap` with the sign of the real part.</span>
<span class="sd">        -  If set to ``&quot;threshold&quot;``, each square is plotted as</span>
<span class="sd">           the maximum of `cmap` for the positive real part and as</span>
<span class="sd">           the minimum for the negative part of the matrix element;</span>
<span class="sd">           note that this generalizes `&quot;threshold&quot;` to complex numbers.</span>
<span class="sd">        -  If set to ``&quot;phase&quot;``, each color is chosen according to</span>
<span class="sd">           the angle of the corresponding matrix element.</span>

<span class="sd">    label_top : bool, default=True</span>
<span class="sd">        If True, x ticklabels will be placed on top, otherwise</span>
<span class="sd">        they will appear below the plot.</span>

<span class="sd">    cmap : a matplotlib colormap instance, optional</span>
<span class="sd">        Color map to use when plotting.</span>

<span class="sd">    colorbar : bool, default=True</span>
<span class="sd">        Whether (True) or not (False) a colorbar should be attached.</span>

<span class="sd">    fig : a matplotlib Figure instance, optional</span>
<span class="sd">        The Figure canvas in which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axes instance, optional</span>
<span class="sd">        The ax context in which the plot will be drawn.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ani : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and the animation instance</span>
<span class="sd">        used to produce the figure.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Input argument is not a quantum object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rhos</span> <span class="o">=</span> <span class="n">_result_state</span><span class="p">(</span><span class="n">rhos</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span> <span class="o">=</span> <span class="n">hinton</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">x_basis</span><span class="p">,</span> <span class="n">y_basis</span><span class="p">,</span> <span class="n">color_style</span><span class="p">,</span> <span class="n">label_top</span><span class="p">,</span>
                      <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span></div>


<div class="viewcode-block" id="anim_sphereplot"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.animation.anim_sphereplot">[docs]</a><span class="k">def</span> <span class="nf">anim_sphereplot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;animation of a matrices of values on a sphere</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    V : list of array instances</span>
<span class="sd">        Data set to be plotted</span>

<span class="sd">    theta : float</span>
<span class="sd">        Angle with respect to z-axis. Its range is between 0 and pi</span>

<span class="sd">    phi : float</span>
<span class="sd">        Angle in x-y plane. Its range is between 0 and 2*pi</span>

<span class="sd">    cmap : a matplotlib colormap instance, optional</span>
<span class="sd">        Color map to use when plotting.</span>

<span class="sd">    colorbar : bool, default=True</span>
<span class="sd">        Whether (True) or not (False) a colorbar should be attached.</span>

<span class="sd">    fig : a matplotlib Figure instance, optional</span>
<span class="sd">        The Figure canvas in which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axes instance, optional</span>
<span class="sd">        The axes context in which the plot will be drawn.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ani : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and the animation instance</span>
<span class="sd">        used to produce the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span> <span class="o">=</span> <span class="n">sphereplot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                          <span class="n">colorbar</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span></div>


<div class="viewcode-block" id="anim_matrix_histogram"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.animation.anim_matrix_histogram">[docs]</a><span class="k">def</span> <span class="nf">anim_matrix_histogram</span><span class="p">(</span><span class="n">Ms</span><span class="p">,</span> <span class="n">x_basis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_basis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">bar_style</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="n">color_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">color_style</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw an animation of a histogram for the matrix M,</span>
<span class="sd">    with the given x and y labels.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Ms : list of matrices or :class:`qutip.solver.Result`</span>
<span class="sd">        The matrix to visualize</span>

<span class="sd">    x_basis : list of strings, optional</span>
<span class="sd">        list of x ticklabels</span>

<span class="sd">    y_basis : list of strings, optional</span>
<span class="sd">        list of y ticklabels</span>

<span class="sd">    limits : list/array with two float numbers, optional</span>
<span class="sd">        The z-axis limits [min, max]</span>

<span class="sd">    bar_style : string, default=&quot;real&quot;</span>

<span class="sd">        -  If set to ``&quot;real&quot;`` (default), each bar is plotted</span>
<span class="sd">           as the real part of the corresponding matrix element</span>
<span class="sd">        -  If set to ``&quot;img&quot;``, each bar is plotted</span>
<span class="sd">           as the imaginary part of the corresponding matrix element</span>
<span class="sd">        -  If set to ``&quot;abs&quot;``, each bar is plotted</span>
<span class="sd">           as the absolute value of the corresponding matrix element</span>
<span class="sd">        -  If set to ``&quot;phase&quot;`` (default), each bar is plotted</span>
<span class="sd">           as the angle of the corresponding matrix element</span>

<span class="sd">    color_limits : list/array with two float numbers, optional</span>
<span class="sd">        The limits of colorbar [min, max]</span>

<span class="sd">    color_style : string, default=&quot;real&quot;</span>
<span class="sd">        Determines how colors are assigned to each square:</span>

<span class="sd">        -  If set to ``&quot;real&quot;`` (default), each color is chosen</span>
<span class="sd">           according to the real part of the corresponding matrix element.</span>
<span class="sd">        -  If set to ``&quot;img&quot;``, each color is chosen according to</span>
<span class="sd">           the imaginary part of the corresponding matrix element.</span>
<span class="sd">        -  If set to ``&quot;abs&quot;``, each color is chosen according to</span>
<span class="sd">           the absolute value of the corresponding matrix element.</span>
<span class="sd">        -  If set to ``&quot;phase&quot;``, each color is chosen according to</span>
<span class="sd">           the angle of the corresponding matrix element.</span>

<span class="sd">    cmap : a matplotlib colormap instance, optional</span>
<span class="sd">        Color map to use when plotting.</span>

<span class="sd">    colorbar : bool, default=True</span>
<span class="sd">        show colorbar</span>

<span class="sd">    fig : a matplotlib Figure instance, optional</span>
<span class="sd">        The Figure canvas in which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axes instance, optional</span>
<span class="sd">        The axes context in which the plot will be drawn.</span>

<span class="sd">    options : dict, optional</span>
<span class="sd">        A dictionary containing extra options for the plot.</span>
<span class="sd">        The names (keys) and values of the options are</span>
<span class="sd">        described below:</span>

<span class="sd">        &#39;zticks&#39; : list of numbers, optional</span>
<span class="sd">            A list of z-axis tick locations.</span>

<span class="sd">        &#39;bars_spacing&#39; : float, default=0.1</span>
<span class="sd">            spacing between bars.</span>

<span class="sd">        &#39;bars_alpha&#39; : float, default=1.</span>
<span class="sd">            transparency of bars, should be in range 0 - 1</span>

<span class="sd">        &#39;bars_lw&#39; : float, default=0.5</span>
<span class="sd">            linewidth of bars&#39; edges.</span>

<span class="sd">        &#39;bars_edgecolor&#39; : color, default=&#39;k&#39;</span>
<span class="sd">            The colors of the bars&#39; edges.</span>
<span class="sd">            Examples: &#39;k&#39;, (0.1, 0.2, 0.5) or &#39;#0f0f0f80&#39;.</span>

<span class="sd">        &#39;shade&#39; : bool, default=True</span>
<span class="sd">            Whether to shade the dark sides of the bars (True) or not (False).</span>
<span class="sd">            The shading is relative to plot&#39;s source of light.</span>

<span class="sd">        &#39;azim&#39; : float, default=-35</span>
<span class="sd">            The azimuthal viewing angle.</span>

<span class="sd">        &#39;elev&#39; : float, default=35</span>
<span class="sd">            The elevation viewing angle.</span>

<span class="sd">        &#39;stick&#39; : bool, default=False</span>
<span class="sd">            Changes xlim and ylim in such a way that bars next to</span>
<span class="sd">            XZ and YZ planes will stick to those planes.</span>
<span class="sd">            This option has no effect if ``ax`` is passed as a parameter.</span>

<span class="sd">        &#39;cbar_pad&#39; : float, default=0.04</span>
<span class="sd">            The fraction of the original axes between the colorbar</span>
<span class="sd">            and the new image axes.</span>
<span class="sd">            (i.e. the padding between the 3D figure and the colorbar).</span>

<span class="sd">        &#39;cbar_to_z&#39; : bool, default=False</span>
<span class="sd">            Whether to set the color of maximum and minimum z-values to the</span>
<span class="sd">            maximum and minimum colors in the colorbar (True) or not (False).</span>

<span class="sd">        &#39;threshold&#39;: float, optional</span>
<span class="sd">            Threshold for when bars of smaller height should be transparent. If</span>
<span class="sd">            not set, all bars are colored according to the color map.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ani : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and the animation instance</span>
<span class="sd">        used to produce the figure.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Input argument is not valid.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Ms</span> <span class="o">=</span> <span class="n">_result_state</span><span class="p">(</span><span class="n">Ms</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span> <span class="o">=</span> <span class="n">matrix_histogram</span><span class="p">(</span><span class="n">Ms</span><span class="p">,</span> <span class="n">x_basis</span><span class="p">,</span> <span class="n">y_basis</span><span class="p">,</span> <span class="n">limits</span><span class="p">,</span> <span class="n">bar_style</span><span class="p">,</span>
                                <span class="n">color_limits</span><span class="p">,</span> <span class="n">color_style</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                <span class="n">colorbar</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span></div>


<div class="viewcode-block" id="anim_fock_distribution"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.animation.anim_fock_distribution">[docs]</a><span class="k">def</span> <span class="nf">anim_fock_distribution</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">fock_numbers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
                           <span class="n">unit_y_range</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Animation of the Fock distribution for a density matrix (or ket)</span>
<span class="sd">    that describes an oscillator mode.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rhos : :class:`qutip.solver.Result` or list of :class:`qutip.Qobj`</span>
<span class="sd">        The density matrix (or ket) of the state to visualize.</span>

<span class="sd">    fock_numbers : list of strings, optional</span>
<span class="sd">        list of x ticklabels to represent fock numbers</span>

<span class="sd">    color : color or list of colors, default=&quot;green&quot;</span>
<span class="sd">        The colors of the bar faces.</span>

<span class="sd">    unit_y_range : bool, default=True</span>
<span class="sd">        Set y-axis limits [0, 1] or not</span>

<span class="sd">    fig : a matplotlib Figure instance, optional</span>
<span class="sd">        The Figure canvas in which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axes instance, optional</span>
<span class="sd">        The axes context in which the plot will be drawn.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ani : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and the animation instance</span>
<span class="sd">        used to produce the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rhos</span> <span class="o">=</span> <span class="n">_result_state</span><span class="p">(</span><span class="n">rhos</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span> <span class="o">=</span> <span class="n">plot_fock_distribution</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">fock_numbers</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span>
                                      <span class="n">unit_y_range</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span></div>


<div class="viewcode-block" id="anim_wigner"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.animation.anim_wigner">[docs]</a><span class="k">def</span> <span class="nf">anim_wigner</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">xvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;clenshaw&#39;</span><span class="p">,</span>
                <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;2d&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Animation of the Wigner function for a density matrix (or ket)</span>
<span class="sd">    that describes an oscillator mode.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rhos : :class:`qutip.solver.Result` or list of :class:`qutip.Qobj`</span>
<span class="sd">        The density matrix (or ket) of the state to visualize.</span>

<span class="sd">    xvec : array_like, optional</span>
<span class="sd">        x-coordinates at which to calculate the Wigner function.</span>

<span class="sd">    yvec : array_like, optional</span>
<span class="sd">        y-coordinates at which to calculate the Wigner function.  Does not</span>
<span class="sd">        apply to the &#39;fft&#39; method.</span>

<span class="sd">    method : string {&#39;clenshaw&#39;, &#39;iterative&#39;, &#39;laguerre&#39;, &#39;fft&#39;},</span>
<span class="sd">        default=&#39;clenshaw&#39;</span>
<span class="sd">        The method used for calculating the wigner function. See the</span>
<span class="sd">        documentation for qutip.wigner for details.</span>

<span class="sd">    projection: string {&#39;2d&#39;, &#39;3d&#39;}, default=&#39;2d&#39;</span>
<span class="sd">        Specify whether the Wigner function is to be plotted as a</span>
<span class="sd">        contour graph (&#39;2d&#39;) or surface plot (&#39;3d&#39;).</span>

<span class="sd">    cmap : a matplotlib cmap instance, optional</span>
<span class="sd">        The colormap.</span>

<span class="sd">    colorbar : bool, default=False</span>
<span class="sd">        Whether (True) or not (False) a colorbar should be attached to the</span>
<span class="sd">        Wigner function graph.</span>

<span class="sd">    fig : a matplotlib Figure instance, optional</span>
<span class="sd">        The Figure canvas in which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axes instance, optional</span>
<span class="sd">        The axes context in which the plot will be drawn.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ani : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and the animation instance</span>
<span class="sd">        used to produce the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rhos</span> <span class="o">=</span> <span class="n">_result_state</span><span class="p">(</span><span class="n">rhos</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span> <span class="o">=</span> <span class="n">plot_wigner</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">projection</span><span class="p">,</span>
                           <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span></div>


<div class="viewcode-block" id="anim_spin_distribution"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.animation.anim_spin_distribution">[docs]</a><span class="k">def</span> <span class="nf">anim_spin_distribution</span><span class="p">(</span><span class="n">Ps</span><span class="p">,</span> <span class="n">THETA</span><span class="p">,</span> <span class="n">PHI</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;2d&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                           <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Animation of a spin distribution (given as meshgrid data).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Ps : list of matrices</span>
<span class="sd">        Distribution values as a meshgrid matrix.</span>

<span class="sd">    THETA : matrix</span>
<span class="sd">        Meshgrid matrix for the theta coordinate. Its range is between 0 and pi</span>

<span class="sd">    PHI : matrix</span>
<span class="sd">        Meshgrid matrix for the phi coordinate. Its range is between 0 and 2*pi</span>

<span class="sd">    projection: string {&#39;2d&#39;, &#39;3d&#39;}, default=&#39;2d&#39;</span>
<span class="sd">        Specify whether the spin distribution function is to be plotted as a 2D</span>
<span class="sd">        projection where the surface of the unit sphere is mapped on</span>
<span class="sd">        the unit disk (&#39;2d&#39;) or surface plot (&#39;3d&#39;).</span>

<span class="sd">    cmap : a matplotlib cmap instance, optional</span>
<span class="sd">        The colormap.</span>

<span class="sd">    colorbar : bool, default=False</span>
<span class="sd">        Whether (True) or not (False) a colorbar should be attached to the</span>
<span class="sd">        Wigner function graph.</span>

<span class="sd">    fig : a matplotlib figure instance, optional</span>
<span class="sd">        The figure canvas on which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axis instance, optional</span>
<span class="sd">        The axis context in which the plot will be drawn.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ani : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and the animation instance</span>
<span class="sd">        used to produce the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span> <span class="o">=</span> <span class="n">plot_spin_distribution</span><span class="p">(</span><span class="n">Ps</span><span class="p">,</span> <span class="n">THETA</span><span class="p">,</span> <span class="n">PHI</span><span class="p">,</span> <span class="n">projection</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                      <span class="n">colorbar</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span></div>


<div class="viewcode-block" id="anim_qubism"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.animation.anim_qubism">[docs]</a><span class="k">def</span> <span class="nf">anim_qubism</span><span class="p">(</span><span class="n">kets</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;pairs&#39;</span><span class="p">,</span> <span class="n">grid_iteration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">legend_iteration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Animation of Qubism plot for pure states of many qudits.</span>
<span class="sd">    Works best for spin chains, especially with even number of particles</span>
<span class="sd">    of the same dimension.  Allows to see entanglement between first</span>
<span class="sd">    2k particles and the rest.</span>

<span class="sd">    .. note::</span>

<span class="sd">        colorblind_safe does not apply because of its unique colormap</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    kets : :class:`qutip.solver.Result` or list of :class:`qutip.Qobj`</span>
<span class="sd">        Pure states for animation.</span>

<span class="sd">    theme : &#39;light&#39; or &#39;dark&#39;, default=&#39;light&#39;</span>
<span class="sd">        Set coloring theme for mapping complex values into colors.</span>
<span class="sd">        See: complex_array_to_rgb.</span>

<span class="sd">    how : &#39;pairs&#39;, &#39;pairs_skewed&#39; or &#39;before_after&#39;, default=&#39;pairs&#39;</span>
<span class="sd">        Type of Qubism plotting.  Options:</span>

<span class="sd">        - &#39;pairs&#39; - typical coordinates,</span>
<span class="sd">        - &#39;pairs_skewed&#39; - for ferromagnetic/antriferromagnetic plots,</span>
<span class="sd">        - &#39;before_after&#39; - related to Schmidt plot (see also: plot_schmidt).</span>

<span class="sd">    grid_iteration : int, default=1</span>
<span class="sd">        Helper lines to be drawn on plot.</span>
<span class="sd">        Show tiles for 2*grid_iteration particles vs all others.</span>

<span class="sd">    legend_iteration : int or &#39;grid_iteration&#39; or &#39;all&#39;, default=0</span>
<span class="sd">        Show labels for first ``2*legend_iteration`` particles.  Option</span>
<span class="sd">        &#39;grid_iteration&#39; sets the same number of particles as for</span>
<span class="sd">        grid_iteration.  Option &#39;all&#39; makes label for all particles.  Typically</span>
<span class="sd">        it should be 0, 1, 2 or perhaps 3.</span>

<span class="sd">    fig : a matplotlib figure instance, optional</span>
<span class="sd">        The figure canvas on which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axis instance, optional</span>
<span class="sd">        The axis context in which the plot will be drawn.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ani : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and the animation instance</span>
<span class="sd">        used to produce the figure.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    See also [1]_.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] J. Rodriguez-Laguna, P. Migdal, M. Ibanez Berganza, M. Lewenstein</span>
<span class="sd">       and G. Sierra, *Qubism: self-similar visualization of many-body</span>
<span class="sd">       wavefunctions*, `New J. Phys. 14 053028</span>
<span class="sd">       &lt;https://dx.doi.org/10.1088/1367-2630/14/5/053028&gt;`_, arXiv:1112.3560</span>
<span class="sd">       (2012), open access.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">kets</span> <span class="o">=</span> <span class="n">_result_state</span><span class="p">(</span><span class="n">kets</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span> <span class="o">=</span> <span class="n">plot_qubism</span><span class="p">(</span><span class="n">kets</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">grid_iteration</span><span class="p">,</span>
                           <span class="n">legend_iteration</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span></div>


<div class="viewcode-block" id="anim_schmidt"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.animation.anim_schmidt">[docs]</a><span class="k">def</span> <span class="nf">anim_schmidt</span><span class="p">(</span><span class="n">kets</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">,</span> <span class="n">splitting</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">labels_iteration</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="o">*</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Animation of Schmidt decomposition.</span>
<span class="sd">    Converts a state into a matrix (A_ij -&gt; A_i^j),</span>
<span class="sd">    where rows are first particles and columns - last.</span>

<span class="sd">    See also: plot_qubism with how=&#39;before_after&#39; for a similar plot.</span>

<span class="sd">    .. note::</span>

<span class="sd">        colorblind_safe does not apply because of its unique colormap</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ket : :class:`qutip.solver.Result` or list of :class:`qutip.Qobj`</span>
<span class="sd">        Pure states for animation.</span>

<span class="sd">    theme : &#39;light&#39; or &#39;dark&#39;, default=&#39;light&#39;</span>
<span class="sd">        Set coloring theme for mapping complex values into colors.</span>
<span class="sd">        See: complex_array_to_rgb.</span>

<span class="sd">    splitting : int, optional</span>
<span class="sd">        Plot for a number of first particles versus the rest.</span>
<span class="sd">        If not given, it is (number of particles + 1) // 2.</span>

<span class="sd">    labels_iteration : int or pair of ints, default=(3,2)</span>
<span class="sd">        Number of particles to be shown as tick labels,</span>
<span class="sd">        for first (vertical) and last (horizontal) particles, respectively.</span>

<span class="sd">    fig : a matplotlib figure instance, optional</span>
<span class="sd">        The figure canvas on which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axis instance, optional</span>
<span class="sd">        The axis context in which the plot will be drawn.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ani : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and the animation instance</span>
<span class="sd">        used to produce the figure.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">kets</span> <span class="o">=</span> <span class="n">_result_state</span><span class="p">(</span><span class="n">kets</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span> <span class="o">=</span> <span class="n">plot_schmidt</span><span class="p">(</span><span class="n">kets</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">splitting</span><span class="p">,</span> <span class="n">labels_iteration</span><span class="p">,</span>
                            <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ani</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../copyright.html">Copyright</a> 2011 to 2021 inclusive, QuTiP developers and contributors.
      <span class="lastupdated">Last updated on Sep 07, 2023.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>