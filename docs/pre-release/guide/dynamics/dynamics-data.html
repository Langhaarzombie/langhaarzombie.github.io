
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dynamics Simulation Results &mdash; QuTiP 5.0 Documentation</title>
      <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../../static/site.css" type="text/css" />
    <link rel="shortcut icon" href="../../static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../static/documentation_options.js"></script>
        <script src="../../static/doctools.js"></script>
        <script src="../../static/sphinx_highlight.js"></script>
    <script src="../../static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="Lindblad Master Equation Solver" href="dynamics-master.html" />
    <link rel="prev" title="Introduction" href="dynamics-intro.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            QuTiP: Quantum Toolbox in Python
          </a>
              <div class="version">
                5.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../frontmatter.html">Frontmatter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../guide.html">Users Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../guide-overview.html">Guide Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-basics.html">Basic Operations on Quantum Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-states.html">Manipulating States and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-tensor.html">Using Tensor Products and Partial Traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-super.html">Superoperators, Pauli Basis and Channel Contraction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../guide-dynamics.html">Time Evolution and Quantum System Dynamics</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="dynamics-intro.html">Introduction</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Dynamics Simulation Results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-solver-result-class">The solver.Result Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accessing-result-data">Accessing Result Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiple-trajectories-solver-results">Multiple Trajectories Solver Results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dynamics-master.html">Lindblad Master Equation Solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamics-monte.html">Monte Carlo Solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamics-krylov.html">Krylov Solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamics-stochastic.html">Stochastic Solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamics-time.html">Solving Problems with Time-dependent Hamiltonians</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamics-bloch-redfield.html">Bloch-Redfield master equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamics-floquet.html">Floquet Formalism</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamics-piqs.html">Permutational Invariance</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamics-options.html">Setting Options for the Dynamics Solvers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide-heom.html">Hierarchical Equations of Motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-steady.html">Solving for Steady-State Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-correlation.html">Two-time correlation functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-control.html">Quantum Optimal Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-bloch.html">Plotting on the Bloch Sphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-visualization.html">Visualization of quantum states and processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-parfor.html">Parallel computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-saving.html">Saving QuTiP Objects and Data Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-random.html">Generating Random Quantum States &amp; Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-settings.html">Modifying Internal QuTiP Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-measurement.html">Measurement of Quantum Objects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery/build/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/apidoc.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/development.html">Development Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../biblio.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../copyright.html">Copyright and Licensing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QuTiP: Quantum Toolbox in Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../guide.html">Users Guide</a></li>
          <li class="breadcrumb-item"><a href="../guide-dynamics.html">Time Evolution and Quantum System Dynamics</a></li>
      <li class="breadcrumb-item active">Dynamics Simulation Results</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dynamics-simulation-results">
<span id="solver-result"></span><h1>Dynamics Simulation Results<a class="headerlink" href="#dynamics-simulation-results" title="Permalink to this heading"></a></h1>
<section id="the-solver-result-class">
<span id="solver-result-class"></span><h2>The solver.Result Class<a class="headerlink" href="#the-solver-result-class" title="Permalink to this heading"></a></h2>
<p>Before embarking on simulating the dynamics of quantum systems, we will first look at the data structure used for returning the simulation results.
This object is a <code class="xref py py-func docutils literal notranslate"><span class="pre">qutip.Result</span></code> class that stores all the crucial data needed for analyzing and plotting the results of a simulation.
A generic <code class="docutils literal notranslate"><span class="pre">Result</span></code> object <code class="docutils literal notranslate"><span class="pre">result</span></code> contains the following properties for storing simulation data:</p>
<table class="table-striped docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">result.solver</span></code></p></td>
<td><p>String indicating which solver was used to generate the data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">result.times</span></code></p></td>
<td><p>List/array of times at which simulation data is calculated.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">result.expect</span></code></p></td>
<td><p>List/array of expectation values, if requested.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">result.e_data</span></code></p></td>
<td><p>Dictionary of expectation values, if requested.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">result.states</span></code></p></td>
<td><p>List/array of state vectors/density matrices calculated at <code class="docutils literal notranslate"><span class="pre">times</span></code>,
if requested.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">result.final_state</span></code></p></td>
<td><p>State vector or density matrix at the last time of the evolution.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">result.stats</span></code></p></td>
<td><p>Various statistics about the evolution including the integration
method used, number of collapse operators etc.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="accessing-result-data">
<span id="odedata-access"></span><h2>Accessing Result Data<a class="headerlink" href="#accessing-result-data" title="Permalink to this heading"></a></h2>
<p>To understand how to access the data in a Result object we will use an example as a guide, although we do not worry about the simulation details at this stage.
Like all solvers, the Master Equation solver used in this example returns an Result object, here called simply <code class="docutils literal notranslate"><span class="pre">result</span></code>.
To see what is contained inside <code class="docutils literal notranslate"><span class="pre">result</span></code> we can use the print function:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">&lt;Result</span>
<span class="go">  Solver: mesolve</span>
<span class="go">  Solver stats:</span>
<span class="go">    method: &#39;scipy zvode adams&#39;</span>
<span class="go">    init time: 0.0001876354217529297</span>
<span class="go">    preparation time: 0.007544517517089844</span>
<span class="go">    run time: 0.001268625259399414</span>
<span class="go">    solver: &#39;Master Equation Evolution&#39;</span>
<span class="go">    num_collapse: 1</span>
<span class="go">  Time interval: [0, 1.0] (2 steps)</span>
<span class="go">  Number of e_ops: 1</span>
<span class="go">  State not saved.</span>
<span class="go">&gt;</span>
</pre></div>
</div>
<p>The first line tells us that this data object was generated from the Master Equation solver <code class="xref py py-func docutils literal notranslate"><span class="pre">mesolve</span></code>.
Next we have the statistics including the ODE solver used, setup time, number of collpases.
Then the integration interval is described, followed with the number of expectation value computed.
Finally, it says whether the states are stored.</p>
<p>Now we have all the information needed to analyze the simulation results.
To access the data for the two expectation values one can do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">expt0</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">expect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">expt1</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">expect</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Recall that Python uses C-style indexing that begins with zero (i.e., [0] =&gt; 1st collapse operator data).
Alternatively, expectation values can be obtained as a dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">e_ops</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;sx&quot;</span><span class="p">:</span> <span class="n">sigmax</span><span class="p">(),</span> <span class="s2">&quot;sy&quot;</span><span class="p">:</span> <span class="n">sigmay</span><span class="p">(),</span> <span class="s2">&quot;sz&quot;</span><span class="p">:</span> <span class="n">sigmaz</span><span class="p">()}</span>
<span class="o">...</span>
<span class="n">expt_sx</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">e_data</span><span class="p">[</span><span class="s2">&quot;sx&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">e_ops</span></code> is a list, <code class="docutils literal notranslate"><span class="pre">e_data</span></code> ca be used with the list index.
Together with the array of times at which these expectation values are calculated:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">times</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">times</span>
</pre></div>
</div>
<p>we can plot the resulting expectation values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">expt0</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">expt1</span><span class="p">)</span>
<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>State vectors, or density matrices, are accessed in a similar manner, although typically one does not need an index (i.e [0]) since there is only one list for each of these components.
Some other solver can have other output, <code class="xref py py-func docutils literal notranslate"><span class="pre">heomsolve</span></code>’s results can have <code class="docutils literal notranslate"><span class="pre">ado_states</span></code> output if the options <code class="docutils literal notranslate"><span class="pre">store_ados</span></code> is set, similarly, <code class="xref py py-func docutils literal notranslate"><span class="pre">fmesolve</span></code> can return <cite>floquet_states</cite>.</p>
</section>
<section id="multiple-trajectories-solver-results">
<h2>Multiple Trajectories Solver Results<a class="headerlink" href="#multiple-trajectories-solver-results" title="Permalink to this heading"></a></h2>
<p>Solver which compute multiple trajectories such as the Monte Carlo Equations Solvers or the Stochastics Solvers result will differ depending on whether the trajectories are flags to be saved.
For example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mcsolve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">c_ops</span><span class="p">,</span> <span class="n">e_ops</span><span class="o">=</span><span class="p">[</span><span class="n">num</span><span class="p">(</span><span class="n">N</span><span class="p">)],</span> <span class="n">ntraj</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;keep_runs_results&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">expect</span><span class="p">)</span>
<span class="go">(1, 11)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">mcsolve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">c_ops</span><span class="p">,</span> <span class="n">e_ops</span><span class="o">=</span><span class="p">[</span><span class="n">num</span><span class="p">(</span><span class="n">N</span><span class="p">)],</span> <span class="n">ntraj</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;keep_runs_results&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">expect</span><span class="p">)</span>
<span class="go">(1, 25, 11)</span>
</pre></div>
</div>
<p>When the runs are not saved, the expectation values and states are averaged over all trajectories, while a list over the runs are given when they are stored.
For a fix output format, <code class="docutils literal notranslate"><span class="pre">average_expect</span></code> return the average, while <code class="docutils literal notranslate"><span class="pre">runs_states</span></code> return the list over trajectories.
The <code class="docutils literal notranslate"><span class="pre">runs_</span></code> output will return <code class="docutils literal notranslate"><span class="pre">None</span></code> when the trajectories are not saved.
Standard derivation of the expectation values is also available:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Reduced result</p></th>
<th class="head"><p>Trajectories results</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">average_states</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">runs_states</span></code></p></td>
<td><p>State vectors or density matrices calculated at each times of tlist</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">average_final_state</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">runs_final_state</span></code></p></td>
<td><p>State vectors or density matrices calculated at the last time of tlist</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">average_expect</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">runs_expect</span></code></p></td>
<td><p>List/array of expectation values, if requested.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">std_expect</span></code></p></td>
<td></td>
<td><p>List/array of standard derivation of the expectation values.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">average_e_data</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">runs_e_data</span></code></p></td>
<td><p>Dictionary of expectation values, if requested.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">std_e_data</span></code></p></td>
<td></td>
<td><p>Dictionary of standard derivation of the expectation values.</p></td>
</tr>
</tbody>
</table>
<p>Multiple trajectories results also keep the trajectories seeds to allows recomputing the results.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">seeds</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">seeds</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dynamics-intro.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dynamics-master.html" class="btn btn-neutral float-right" title="Lindblad Master Equation Solver" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../copyright.html">Copyright</a> 2011 to 2021 inclusive, QuTiP developers and contributors.
      <span class="lastupdated">Last updated on Sep 07, 2023.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>