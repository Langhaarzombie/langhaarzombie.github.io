


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Plotting on the Bloch Sphere &mdash; QuTiP 5.0 Documentation</title>
  

  
  <link rel="stylesheet" href="../static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../static/gallery-rendered-html.css" type="text/css" />
  <link rel="stylesheet" href="../static/site.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../static/documentation_options.js"></script>
        <script src="../static/jquery.js"></script>
        <script src="../static/underscore.js"></script>
        <script src="../static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"bra": ["\\left\\langle{#1}\\right\\rvert", 1], "ket": ["\\left\\lvert{#1}\\right\\rangle", 1], "tr": "\\operatorname{tr}"}}})</script>
    
    <script type="text/javascript" src="../static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Visualization of quantum states and processes" href="guide-visualization.html" />
    <link rel="prev" title="Quantum Optimal Control" href="guide-control.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> QuTiP: Quantum Toolbox in Python
          

          
          </a>

          
            
            
              <div class="version">
                5.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../frontmatter.html">Frontmatter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="guide.html">Users Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="guide-overview.html">Guide Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-basics.html">Basic Operations on Quantum Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-states.html">Manipulating States and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-tensor.html">Using Tensor Products and Partial Traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-dynamics.html">Time Evolution and Quantum System Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-heom.html">Hierarchical Equations of Motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-steady.html">Solving for Steady-State Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-correlation.html">Two-time correlation functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-control.html">Quantum Optimal Control</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Plotting on the Bloch Sphere</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-bloch-and-bloch3d-classes">The Bloch and Bloch3d Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#differences-between-bloch-and-bloch3d">Differences Between Bloch and Bloch3d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-the-bloch-sphere">Configuring the Bloch sphere</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bloch-class-options">Bloch Class Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch3d-class-options">Bloch3d Class Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#animating-with-the-bloch-sphere">Animating with the Bloch sphere</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-qubit-decay">Example: Qubit Decay</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="guide-visualization.html">Visualization of quantum states and processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-parfor.html">Parallel computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-saving.html">Saving QuTiP Objects and Data Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-random.html">Generating Random Quantum States &amp; Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-settings.html">Modifying Internal QuTiP Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-measurement.html">Measurement of Quantum Objects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/build/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/apidoc.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/development.html">Development Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../biblio.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">Copyright and Licensing</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuTiP: Quantum Toolbox in Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="guide.html">Users Guide</a> &raquo;</li>
        
      <li>Plotting on the Bloch Sphere</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="plotting-on-the-bloch-sphere">
<span id="bloch"></span><h1>Plotting on the Bloch Sphere<a class="headerlink" href="#plotting-on-the-bloch-sphere" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<span id="bloch-intro"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>When studying the dynamics of a two-level system, it is often convenient to visualize the state of the system by plotting the state-vector or density matrix on the Bloch sphere.  In QuTiP, we have created two different classes to allow for easy creation and manipulation of data sets, both vectors and data points, on the Bloch sphere.  The <a class="reference internal" href="../apidoc/classes.html#qutip.bloch.Bloch" title="qutip.bloch.Bloch"><code class="xref py py-class docutils literal notranslate"><span class="pre">qutip.bloch.Bloch</span></code></a> class, uses Matplotlib to render the Bloch sphere, where as <a class="reference internal" href="../apidoc/classes.html#qutip.bloch3d.Bloch3d" title="qutip.bloch3d.Bloch3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">qutip.bloch3d.Bloch3d</span></code></a> uses the Mayavi rendering engine to generate a more faithful 3D reconstruction of the Bloch sphere.</p>
</div>
<div class="section" id="the-bloch-and-bloch3d-classes">
<span id="bloch-class"></span><h2>The Bloch and Bloch3d Classes<a class="headerlink" href="#the-bloch-and-bloch3d-classes" title="Permalink to this headline">¶</a></h2>
<p>In QuTiP, creating a Bloch sphere is accomplished by calling either:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">Bloch</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-1.png" src="../images/guide-bloch-1.png" />
</div>
<p>which will load an instance of the <a class="reference internal" href="../apidoc/classes.html#qutip.bloch.Bloch" title="qutip.bloch.Bloch"><code class="xref py py-class docutils literal notranslate"><span class="pre">qutip.bloch.Bloch</span></code></a> class, or using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b3d</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">Bloch3d</span><span class="p">()</span>
</pre></div>
</div>
<p>that loads the <a class="reference internal" href="../apidoc/classes.html#qutip.bloch3d.Bloch3d" title="qutip.bloch3d.Bloch3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">qutip.bloch3d.Bloch3d</span></code></a> version.  Before getting into the details of these objects, we can simply plot the blank Bloch sphere associated with these instances via:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">make_sphere</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-2_00.png" src="../images/guide-bloch-2_00.png" />
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-2_01.png" src="../images/guide-bloch-2_01.png" />
</div>
<p>or</p>
<div class="align-center figure align-default" id="image-blank3d">
<a class="reference internal image-reference" href="../images/bloch3d-blank.png"><img alt="../images/bloch3d-blank.png" src="../images/bloch3d-blank.png" style="width: 3.5in;" /></a>
</div>
<p>In addition to the <code class="docutils literal notranslate"><span class="pre">show</span></code> command, see the API documentation for <a class="reference internal" href="../apidoc/classes.html#qutip.bloch.Bloch" title="qutip.bloch.Bloch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bloch</span></code></a> for a full list of other available functions.
As an example, we can add a single data point:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pnt</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="n">b</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">pnt</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-3.png" src="../images/guide-bloch-3.png" />
</div>
<p>and then a single vector:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="n">vec</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">b</span><span class="o">.</span><span class="n">add_vectors</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-4.png" src="../images/guide-bloch-4.png" />
</div>
<p>and then add another vector corresponding to the <span class="math notranslate nohighlight">\(\left|\rm up \right&gt;\)</span> state:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">up</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">add_states</span><span class="p">(</span><span class="n">up</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-5.png" src="../images/guide-bloch-5.png" />
</div>
<p>Notice that when we add more than a single vector (or data point), a different color will automatically be applied to the later data set (mod 4).
In total, the code for constructing our Bloch sphere with one vector, one state, and a single data point is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">Bloch</span><span class="p">()</span>

<span class="n">pnt</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="n">b</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">pnt</span><span class="p">)</span>
<span class="n">vec</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">b</span><span class="o">.</span><span class="n">add_vectors</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
<span class="n">up</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">add_states</span><span class="p">(</span><span class="n">up</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-6.png" src="../images/guide-bloch-6.png" />
</div>
<p>where we have removed the extra <code class="docutils literal notranslate"><span class="pre">show()</span></code> commands.  Replacing <code class="docutils literal notranslate"><span class="pre">b=Bloch()</span></code> with <code class="docutils literal notranslate"><span class="pre">b=Bloch3d()</span></code> in the above code generates the following 3D Bloch sphere.</p>
<div class="align-center figure align-default" id="image-bloch3ddata">
<a class="reference internal image-reference" href="../images/bloch3d+data.png"><img alt="../images/bloch3d+data.png" src="../images/bloch3d+data.png" style="width: 3.5in;" /></a>
</div>
<p>We can also plot multiple points, vectors, and states at the same time by passing list or arrays instead of individual elements.  Before giving an example, we can use the <cite>clear()</cite> command to remove the current data from our Bloch sphere instead of creating a new instance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">b</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-7.png" src="../images/guide-bloch-7.png" />
</div>
<p>Now on the same Bloch sphere, we can plot the three states associated with the x, y, and z directions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">qutip</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">qutip</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">qutip</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">qutip</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">qutip</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">qutip</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>

<span class="n">b</span><span class="o">.</span><span class="n">add_states</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>
<span class="n">b</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-8.png" src="../images/guide-bloch-8.png" />
</div>
<p>a similar method works for adding vectors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">vec</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="n">b</span><span class="o">.</span><span class="n">add_vectors</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-9.png" src="../images/guide-bloch-9.png" />
</div>
<p>Adding multiple points to the Bloch sphere works slightly differently than adding multiple states or vectors.  For example, lets add a set of 20 points around the equator (after calling <cite>clear()</cite>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

<span class="n">th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">zp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="n">pnts</span> <span class="o">=</span> <span class="p">[</span><span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="n">zp</span><span class="p">]</span>
<span class="n">b</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">pnts</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-10.png" src="../images/guide-bloch-10.png" />
</div>
<p>Notice that, in contrast to states or vectors, each point remains the same color as the initial point.  This is because adding multiple data points using the <code class="docutils literal notranslate"><span class="pre">add_points</span></code> function is interpreted, by default, to correspond to a single data point (single qubit state) plotted at different times.  This is very useful when visualizing the dynamics of a qubit.  An example of this is given in the example .  If we want to plot additional qubit states we can call additional <code class="docutils literal notranslate"><span class="pre">add_points</span></code> functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">yz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">zz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">add_points</span><span class="p">([</span><span class="n">xz</span><span class="p">,</span> <span class="n">yz</span><span class="p">,</span> <span class="n">zz</span><span class="p">])</span>
<span class="n">b</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-11.png" src="../images/guide-bloch-11.png" />
</div>
<p>The color and shape of the data points is varied automatically by the Bloch class.  Notice how the color and point markers change for each set of data.  Again, we have had to call <code class="docutils literal notranslate"><span class="pre">add_points</span></code> twice because adding more than one set of multiple data points is <em>not</em> supported by the <code class="docutils literal notranslate"><span class="pre">add_points</span></code> function.</p>
<p>What if we want to vary the color of our points.  We can tell the <a class="reference internal" href="../apidoc/classes.html#qutip.bloch.Bloch" title="qutip.bloch.Bloch"><code class="xref py py-class docutils literal notranslate"><span class="pre">qutip.bloch.Bloch</span></code></a> class to vary the color of each point according to the colors listed in the <code class="docutils literal notranslate"><span class="pre">b.point_color</span></code> list (see <a class="reference internal" href="#bloch-config"><span class="std std-ref">Configuring the Bloch sphere</span></a> below).  Again after <code class="docutils literal notranslate"><span class="pre">clear()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

<span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">zp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">pnts</span> <span class="o">=</span> <span class="p">[</span><span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="n">zp</span><span class="p">]</span>
<span class="n">b</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">pnts</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>  <span class="c1"># &lt;-- add a &#39;m&#39; string to signify &#39;multi&#39; colored points</span>
<span class="n">b</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-12.png" src="../images/guide-bloch-12.png" />
</div>
<p>Now, the data points cycle through a variety of predefined colors.  Now lets add another set of points, but this time we want the set to be a single color, representing say a qubit going from the <span class="math notranslate nohighlight">\(\left|\rm up\right&gt;\)</span> state to the <span class="math notranslate nohighlight">\(\left|\rm down\right&gt;\)</span> state in the y-z plane:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">yz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">zz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>

<span class="n">b</span><span class="o">.</span><span class="n">add_points</span><span class="p">([</span><span class="n">xz</span><span class="p">,</span> <span class="n">yz</span><span class="p">,</span> <span class="n">zz</span><span class="p">])</span>  <span class="c1"># no &#39;m&#39;</span>
<span class="n">b</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../images/guide-bloch-13.png" src="../images/guide-bloch-13.png" />
</div>
<p>Again, the same plot can be generated using the <a class="reference internal" href="../apidoc/classes.html#qutip.bloch3d.Bloch3d" title="qutip.bloch3d.Bloch3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">qutip.bloch3d.Bloch3d</span></code></a> class by replacing <code class="docutils literal notranslate"><span class="pre">Bloch</span></code> with <code class="docutils literal notranslate"><span class="pre">Bloch3d</span></code>:</p>
<div class="align-center figure align-default">
<a class="reference internal image-reference" href="../images/bloch3d+points.png"><img alt="../images/bloch3d+points.png" src="../images/bloch3d+points.png" style="width: 3.5in;" /></a>
</div>
<p>A more slick way of using this ‘multi’ color feature is also given in the example, where we set the color of the markers as a function of time.</p>
<div class="section" id="differences-between-bloch-and-bloch3d">
<h3>Differences Between Bloch and Bloch3d<a class="headerlink" href="#differences-between-bloch-and-bloch3d" title="Permalink to this headline">¶</a></h3>
<p>While in general the <code class="docutils literal notranslate"><span class="pre">Bloch</span></code> and <code class="docutils literal notranslate"><span class="pre">Bloch3d</span></code> classes are interchangeable, there are some important differences to consider when choosing between them.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">Bloch</span></code> class uses Matplotlib to generate figures.  As such, the data plotted on the sphere is in reality just a 2D object.  In contrast the <code class="docutils literal notranslate"><span class="pre">Bloch3d</span></code> class uses the 3D rendering engine from VTK via mayavi to generate the sphere and the included data.  In this sense the <code class="docutils literal notranslate"><span class="pre">Bloch3d</span></code> class is much more advanced, as objects are rendered in 3D leading to a higher quality figure.</p></li>
<li><p>Only the <code class="docutils literal notranslate"><span class="pre">Bloch</span></code> class can be embedded in a Matplotlib figure window.  Thus if you want to combine a Bloch sphere with another figure generated in QuTiP, you can not use <code class="docutils literal notranslate"><span class="pre">Bloch3d</span></code>.  Of course you can always post-process your figures using other software to get the desired result.</p></li>
<li><p>Due to limitations in the rendering engine, the <code class="docutils literal notranslate"><span class="pre">Bloch3d</span></code> class does not support LaTeX for text.  Again, you can get around this by post-processing.</p></li>
<li><p>The user customizable attributes for the <code class="docutils literal notranslate"><span class="pre">Bloch</span></code> and <code class="docutils literal notranslate"><span class="pre">Bloch3d</span></code> classes are not identical.  Therefore, if you change the properties of one of the classes, these changes will cause an exception if the class is switched.</p></li>
</ul>
</div>
</div>
<div class="section" id="configuring-the-bloch-sphere">
<span id="bloch-config"></span><h2>Configuring the Bloch sphere<a class="headerlink" href="#configuring-the-bloch-sphere" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bloch-class-options">
<h3>Bloch Class Options<a class="headerlink" href="#bloch-class-options" title="Permalink to this headline">¶</a></h3>
<p>At the end of the last section we saw that the colors and marker shapes of the data plotted on the Bloch sphere are automatically varied according to the number of points and vectors added.  But what if you want a different choice of color, or you want your sphere to be purple with different axes labels? Well then you are in luck as the Bloch class has 22 attributes which one can control.  Assuming <code class="docutils literal notranslate"><span class="pre">b=Bloch()</span></code>:</p>
<table class="table-striped docutils align-default">
<colgroup>
<col style="width: 12%" />
<col style="width: 47%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Default Setting</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>b.axes</p></td>
<td><p>Matplotlib axes instance for animations. Set by <code class="docutils literal notranslate"><span class="pre">axes</span></code>
keyword arg.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>b.fig</p></td>
<td><p>User supplied Matplotlib Figure instance. Set by <code class="docutils literal notranslate"><span class="pre">fig</span></code>
keyword arg.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
</tr>
<tr class="row-even"><td><p>b.font_color</p></td>
<td><p>Color of fonts</p></td>
<td><p>‘black’</p></td>
</tr>
<tr class="row-odd"><td><p>b.font_size</p></td>
<td><p>Size of fonts</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-even"><td><p>b.frame_alpha</p></td>
<td><p>Transparency of wireframe</p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-odd"><td><p>b.frame_color</p></td>
<td><p>Color of wireframe</p></td>
<td><p>‘gray’</p></td>
</tr>
<tr class="row-even"><td><p>b.frame_width</p></td>
<td><p>Width of wireframe</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>b.point_color</p></td>
<td><p>List of colors for Bloch point markers to cycle through</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">['b',</span> <span class="pre">'r',</span> <span class="pre">'g',</span> <span class="pre">'#CC6600']</span></code></p></td>
</tr>
<tr class="row-even"><td><p>b.point_marker</p></td>
<td><p>List of point marker shapes to cycle through</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">['o',</span> <span class="pre">'s',</span> <span class="pre">'d',</span> <span class="pre">'^']</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>b.point_size</p></td>
<td><p>List of point marker sizes (not all markers look the
same size when plotted)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[55,</span> <span class="pre">62,</span> <span class="pre">65,</span> <span class="pre">75]</span></code></p></td>
</tr>
<tr class="row-even"><td><p>b.sphere_alpha</p></td>
<td><p>Transparency of Bloch sphere</p></td>
<td><p>0.2</p></td>
</tr>
<tr class="row-odd"><td><p>b.sphere_color</p></td>
<td><p>Color of Bloch sphere</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'#FFDDDD'</span></code></p></td>
</tr>
<tr class="row-even"><td><p>b.size</p></td>
<td><p>Sets size of figure window</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[7,</span> <span class="pre">7]</span></code> (700x700 pixels)</p></td>
</tr>
<tr class="row-odd"><td><p>b.vector_color</p></td>
<td><p>List of colors for Bloch vectors to cycle through</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">['g',</span> <span class="pre">'#CC6600',</span> <span class="pre">'b',</span> <span class="pre">'r']</span></code></p></td>
</tr>
<tr class="row-even"><td><p>b.vector_width</p></td>
<td><p>Width of Bloch vectors</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>b.view</p></td>
<td><p>Azimuthal and Elevation viewing angles</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[-60,30]</span></code></p></td>
</tr>
<tr class="row-even"><td><p>b.xlabel</p></td>
<td><p>Labels for x-axis</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">['$x$',</span> <span class="pre">'']</span></code> +x and -x (labels use LaTeX)</p></td>
</tr>
<tr class="row-odd"><td><p>b.xlpos</p></td>
<td><p>Position of x-axis labels</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[1.1,</span> <span class="pre">-1.1]</span></code></p></td>
</tr>
<tr class="row-even"><td><p>b.ylabel</p></td>
<td><p>Labels for y-axis</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">['$y$',</span> <span class="pre">'']</span></code> +y and -y (labels use LaTeX)</p></td>
</tr>
<tr class="row-odd"><td><p>b.ylpos</p></td>
<td><p>Position of y-axis labels</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[1.2,</span> <span class="pre">-1.2]</span></code></p></td>
</tr>
<tr class="row-even"><td><p>b.zlabel</p></td>
<td><p>Labels for z-axis</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">['$\left|0\right&gt;$',</span> <span class="pre">'$\left|1\right&gt;$']</span></code>
+z and -z (labels use LaTeX)</p></td>
</tr>
<tr class="row-odd"><td><p>b.zlpos</p></td>
<td><p>Position of z-axis labels</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[1.2,</span> <span class="pre">-1.2]</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="bloch3d-class-options">
<h3>Bloch3d Class Options<a class="headerlink" href="#bloch3d-class-options" title="Permalink to this headline">¶</a></h3>
<p>The Bloch3d sphere is also customizable.  Note however that the attributes for the <code class="docutils literal notranslate"><span class="pre">Bloch3d</span></code> class are not in one-to-one
correspondence to those of the <code class="docutils literal notranslate"><span class="pre">Bloch</span></code> class due to the different underlying rendering engines. Assuming <code class="docutils literal notranslate"><span class="pre">b=Bloch3d()</span></code>:</p>
<table class="table-striped docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 49%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Function</p></th>
<th class="head"><p>Default Setting</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>b.fig</p></td>
<td><p>User supplied Mayavi Figure instance. Set by <code class="docutils literal notranslate"><span class="pre">fig</span></code>
keyword arg.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>b.font_color</p></td>
<td><p>Color of fonts</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'black'</span></code></p></td>
</tr>
<tr class="row-even"><td><p>b.font_scale</p></td>
<td><p>Scale of fonts</p></td>
<td><p>0.08</p></td>
</tr>
<tr class="row-odd"><td><p>b.frame</p></td>
<td><p>Draw wireframe for sphere?</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-even"><td><p>b.frame_alpha</p></td>
<td><p>Transparency of wireframe</p></td>
<td><p>0.05</p></td>
</tr>
<tr class="row-odd"><td><p>b.frame_color</p></td>
<td><p>Color of wireframe</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'gray'</span></code></p></td>
</tr>
<tr class="row-even"><td><p>b.frame_num</p></td>
<td><p>Number of wireframe elements to draw</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>b.frame_radius</p></td>
<td><p>Radius of wireframe lines</p></td>
<td><p>0.005</p></td>
</tr>
<tr class="row-even"><td><p>b.point_color</p></td>
<td><p>List of colors for Bloch point markers to cycle through</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">['r',</span> <span class="pre">'g',</span> <span class="pre">'b',</span> <span class="pre">'y']</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>b.point_mode</p></td>
<td><p>Type of point markers to draw</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'sphere'</span></code></p></td>
</tr>
<tr class="row-even"><td><p>b.point_size</p></td>
<td><p>Size of points</p></td>
<td><p>0.075</p></td>
</tr>
<tr class="row-odd"><td><p>b.sphere_alpha</p></td>
<td><p>Transparency of Bloch sphere</p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-even"><td><p>b.sphere_color</p></td>
<td><p>Color of Bloch sphere</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'#808080'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>b.size</p></td>
<td><p>Sets size of figure window</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[500,</span> <span class="pre">500]</span></code> (500x500 pixels)</p></td>
</tr>
<tr class="row-even"><td><p>b.vector_color</p></td>
<td><p>List of colors for Bloch vectors to cycle through</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">['r',</span> <span class="pre">'g',</span> <span class="pre">'b',</span> <span class="pre">'y']</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>b.vector_width</p></td>
<td><p>Width of Bloch vectors</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>b.view</p></td>
<td><p>Azimuthal and Elevation viewing angles</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[45,</span> <span class="pre">65]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>b.xlabel</p></td>
<td><p>Labels for x-axis</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">['|x&gt;',</span> <span class="pre">'']</span></code> +x and -x</p></td>
</tr>
<tr class="row-even"><td><p>b.xlpos</p></td>
<td><p>Position of x-axis labels</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[1.07,</span> <span class="pre">-1.07]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>b.ylabel</p></td>
<td><p>Labels for y-axis</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">['$y$',</span> <span class="pre">'']</span></code> +y and -y</p></td>
</tr>
<tr class="row-even"><td><p>b.ylpos</p></td>
<td><p>Position of y-axis labels</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[1.07,</span> <span class="pre">-1.07]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>b.zlabel</p></td>
<td><p>Labels for z-axis</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">['|0&gt;',</span> <span class="pre">'|1&gt;']</span></code> +z and -z</p></td>
</tr>
<tr class="row-even"><td><p>b.zlpos</p></td>
<td><p>Position of z-axis labels</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[1.07,</span> <span class="pre">-1.07]</span></code></p></td>
</tr>
</tbody>
</table>
<p>These properties can also be accessed via the print command:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">Bloch</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> 
<span class="go">Bloch data:</span>
<span class="go">-----------</span>
<span class="go">Number of points:  0</span>
<span class="go">Number of vectors: 0</span>

<span class="go">Bloch sphere properties:</span>
<span class="go">------------------------</span>
<span class="go">font_color:      black</span>
<span class="go">font_size:       20</span>
<span class="go">frame_alpha:     0.2</span>
<span class="go">frame_color:     gray</span>
<span class="go">frame_width:     1</span>
<span class="go">point_color:     [&#39;b&#39;, &#39;r&#39;, &#39;g&#39;, &#39;#CC6600&#39;]</span>
<span class="go">point_marker:    [&#39;o&#39;, &#39;s&#39;, &#39;d&#39;, &#39;^&#39;]</span>
<span class="go">point_size:      [25, 32, 35, 45]</span>
<span class="go">sphere_alpha:    0.2</span>
<span class="go">sphere_color:    #FFDDDD</span>
<span class="go">figsize:         [5, 5]</span>
<span class="go">vector_color:    [&#39;g&#39;, &#39;#CC6600&#39;, &#39;b&#39;, &#39;r&#39;]</span>
<span class="go">vector_width:    3</span>
<span class="go">vector_style:    -|&gt;</span>
<span class="go">vector_mutation: 20</span>
<span class="go">view:            [-60, 30]</span>
<span class="go">xlabel:          [&#39;$x$&#39;, &#39;&#39;]</span>
<span class="go">xlpos:           [1.2, -1.2]</span>
<span class="go">ylabel:          [&#39;$y$&#39;, &#39;&#39;]</span>
<span class="go">ylpos:           [1.2, -1.2]</span>
<span class="go">zlabel:          [&#39;$\\left|0\\right&gt;$&#39;, &#39;$\\left|1\\right&gt;$&#39;]</span>
<span class="go">zlpos:           [1.2, -1.2]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="animating-with-the-bloch-sphere">
<span id="bloch-animate"></span><h2>Animating with the Bloch sphere<a class="headerlink" href="#animating-with-the-bloch-sphere" title="Permalink to this headline">¶</a></h2>
<p>The Bloch class was designed from the outset to generate animations.  To animate a set of vectors or data points the basic idea is: plot the data at time t1, save the sphere, clear the sphere, plot data at t2,… The Bloch sphere will automatically number the output file based on how many times the object has been saved (this is stored in b.savenum).  The easiest way to animate data on the Bloch sphere is to use the <code class="docutils literal notranslate"><span class="pre">save()</span></code> method and generate a series of images to convert into an animation.  However, as of Matplotlib version 1.1, creating animations is built-in.  We will demonstrate both methods by looking at the decay of a qubit on the bloch sphere.</p>
<div class="section" id="example-qubit-decay">
<span id="bloch-animate-decay"></span><h3>Example: Qubit Decay<a class="headerlink" href="#example-qubit-decay" title="Permalink to this headline">¶</a></h3>
<p>The code for calculating the expectation values for the Pauli spin operators of a qubit decay is given below.  This code is common to both animation examples.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">qutip</span>

<span class="k">def</span> <span class="nf">qubit_integrate</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">gamma1</span><span class="p">,</span> <span class="n">gamma2</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">):</span>
    <span class="c1"># operators and the hamiltonian</span>
    <span class="n">sx</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">sigmax</span><span class="p">()</span>
    <span class="n">sy</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">sigmay</span><span class="p">()</span>
    <span class="n">sz</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">sigmaz</span><span class="p">()</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">sigmam</span><span class="p">()</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">sz</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">sx</span><span class="p">)</span>
    <span class="c1"># collapse operators</span>
    <span class="n">c_op_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_th</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># temperature</span>
    <span class="n">rate</span> <span class="o">=</span> <span class="n">gamma1</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_th</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rate</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span> <span class="n">c_op_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span> <span class="o">*</span> <span class="n">sm</span><span class="p">)</span>
    <span class="n">rate</span> <span class="o">=</span> <span class="n">gamma1</span> <span class="o">*</span> <span class="n">n_th</span>
    <span class="k">if</span> <span class="n">rate</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span> <span class="n">c_op_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span> <span class="o">*</span> <span class="n">sm</span><span class="o">.</span><span class="n">dag</span><span class="p">())</span>
    <span class="n">rate</span> <span class="o">=</span> <span class="n">gamma2</span>
    <span class="k">if</span> <span class="n">rate</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span> <span class="n">c_op_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span> <span class="o">*</span> <span class="n">sz</span><span class="p">)</span>
    <span class="c1"># evolve and calculate expectation values</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">mesolve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">c_op_list</span><span class="p">,</span> <span class="p">[</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sz</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">expect</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">output</span><span class="o">.</span><span class="n">expect</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">output</span><span class="o">.</span><span class="n">expect</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="c1">## calculate the dynamics</span>
<span class="n">w</span>     <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># qubit angular frequency</span>
<span class="n">theta</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>      <span class="c1"># qubit angle from sigma_z axis (toward sigma_x axis)</span>
<span class="n">gamma1</span> <span class="o">=</span> <span class="mf">0.5</span>             <span class="c1"># qubit relaxation rate</span>
<span class="n">gamma2</span> <span class="o">=</span> <span class="mf">0.2</span>             <span class="c1"># qubit dephasing rate</span>
<span class="c1"># initial state</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">psi0</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">qutip</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">qutip</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">tlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
<span class="c1">#expectation values for ploting</span>
<span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sz</span> <span class="o">=</span> <span class="n">qubit_integrate</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">gamma1</span><span class="p">,</span> <span class="n">gamma2</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="generating-images-for-animation">
<span id="bloch-animate-decay-images"></span><h4>Generating Images for Animation<a class="headerlink" href="#generating-images-for-animation" title="Permalink to this headline">¶</a></h4>
<p>An example of generating images for generating an animation outside of Python is given below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">Bloch</span><span class="p">()</span>
<span class="n">b</span><span class="o">.</span><span class="n">vector_color</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span>
<span class="n">b</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sx</span><span class="p">)):</span>
    <span class="n">b</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">b</span><span class="o">.</span><span class="n">add_vectors</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)])</span>
    <span class="n">b</span><span class="o">.</span><span class="n">add_points</span><span class="p">([</span><span class="n">sx</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">sy</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">sz</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">b</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">dirc</span><span class="o">=</span><span class="s1">&#39;temp&#39;</span><span class="p">)</span>  <span class="c1"># saving images to temp directory in current working directory</span>
</pre></div>
</div>
<p>Generating an animation using FFmpeg (for example) is fairly simple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ffmpeg</span> <span class="o">-</span><span class="n">i</span> <span class="n">temp</span><span class="o">/</span><span class="n">bloch_</span><span class="o">%</span><span class="mi">01</span><span class="n">d</span><span class="o">.</span><span class="n">png</span> <span class="n">bloch</span><span class="o">.</span><span class="n">mp4</span>
</pre></div>
</div>
</div>
<div class="section" id="directly-generating-an-animation">
<span id="bloch-animate-decay-direct"></span><h4>Directly Generating an Animation<a class="headerlink" href="#directly-generating-an-animation" title="Permalink to this headline">¶</a></h4>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Generating animations directly from Matplotlib requires installing either MEncoder or FFmpeg.
While either choice works on linux, it is best to choose FFmpeg when running on the Mac.
If using macports just do: <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">port</span> <span class="pre">install</span> <span class="pre">ffmpeg</span></code>.</p>
</div>
<p>The code to directly generate an mp4 movie of the Qubit decay is as follows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span><span class="p">,</span> <span class="n">animation</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">azim</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">elev</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">sphere</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">Bloch</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">animate</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
   <span class="n">sphere</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
   <span class="n">sphere</span><span class="o">.</span><span class="n">add_vectors</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)])</span>
   <span class="n">sphere</span><span class="o">.</span><span class="n">add_points</span><span class="p">([</span><span class="n">sx</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">sy</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">sz</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]])</span>
   <span class="n">sphere</span><span class="o">.</span><span class="n">make_sphere</span><span class="p">()</span>
   <span class="k">return</span> <span class="n">ax</span>

<span class="k">def</span> <span class="nf">init</span><span class="p">():</span>
   <span class="n">sphere</span><span class="o">.</span><span class="n">vector_color</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span>
   <span class="k">return</span> <span class="n">ax</span>

<span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sx</span><span class="p">)),</span>
                              <span class="n">init_func</span><span class="o">=</span><span class="n">init</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;bloch_sphere.mp4&#39;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting movie may be viewed here: <a class="reference external" href="https://raw.githubusercontent.com/qutip/qutip/master/doc/figures/bloch_decay.mp4">bloch_decay.mp4</a></p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="guide-visualization.html" class="btn btn-neutral float-right" title="Visualization of quantum states and processes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="guide-control.html" class="btn btn-neutral float-left" title="Quantum Optimal Control" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; <a href="../copyright.html">Copyright</a> 2011 to 2021 inclusive, QuTiP developers and contributors.
      <span class="lastupdated">
        Last updated on Feb 07, 2023.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>